<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML>
<HEAD>
<meta http-equiv="Content-Language" content="zh-cn">
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>获取物品原始各项数据库字段值参数</title>
</head>

<body>


</br></br>
</br></br>


说明：获取物品原始各项数据库字段值参数</br></br>

格式：通过物品名字取数据库字段值  GetDBItemFieldValue 物品名称  字段名 变量</br>
格式：通过 IDX 字段取数据库字段值 GetDBIdxItemFieldValue   idx 字段名 变量</br></br>

---------------------------------------------------------------------------------------------</br>
示范脚本：</br></br>

[@循环]</br>
#ACT</br>
GetDBItemFieldValue 屠龙  idx  &lt;$STR(N1)&gt;</br>
GetDBItemFieldValue 屠龙  stdmode  &lt;$STR(N2)&gt; </br>
sendmsg 6  idx ：&lt;$STR(N1)&gt; ,stdmode:&lt;$STR(N2)&gt; </br></br></BR></BR>


===========================================================================================================================</BR>
详细参考示范脚本：</BR></BR>

;以下所有内容大家都可以自己选择任何设置方式和应用，不一定非是商铺，可以很多方式也可以很多应用</BR>
;只拿【商铺来购买金币物品】进行举例，如有不足还请见谅，毕竟脚本这个东西需要脑子去无数次的想！</BR>
;本脚本由群友提供有问题可以私密，QQ：815915131 大叔</BR>
;切记！！将下列脚本内容放入到MirServer\Mir200\Envir\Market_Def\QFunction-0.txt中去！</BR>
;――――――――――――――――――――――――――――――商城购物触发字段</BR>
[@BuyShopItem]</BR>
#if</BR>
;――――――――――――――――――――――――――――――检测当前购入的物品是否在你设置允许批量购买的路径名单中</BR>
CHECKTEXTLIST ..\QuestDiary\商城批量购物\金币物品.txt &lt;$STR(S0)&gt;</BR>
#act</BR>
;――――――――――――――――――――――――――――――清理之前购买的物品名和价格（保完全，可以不用）</BR>
MOV S$商城当前购入物品名 </BR>
MOV N$商城当前购入物品单 0</BR>
;――――――――――――――――――――――――――――――将当前价格写入变量</BR>
MOV S$商城当前购入物品名 &lt;$STR(S0)&gt;</BR>
MOV N$商城当前购入物品单价 &lt;$STR(M0)&gt;</BR>
;――――――――――――――――――――――――――――――如果你当前购入的物品是你允许批量购买的物品时，则提取IDX</BR>
GetDBItemFieldValue &lt;$STR(S$商城当前购入物品名)&gt; idx N$商铺购买物品代码</BR>
;――――――――――――――――――――――――――――――转向下段脚本</BR>
goto @在线_商铺批量购买</BR>
break</BR></BR>

;――――――――――――――――――――――――――――――――――――――――――――――――――――――――金币类批量购买</BR>

[@在线_商铺批量购买]</BR>
#act</BR>
;――――――――――――――――――――――――――――――设置自定义对话框</BR>
OPENMERCHANTBIGDLG 176 19 1 0 10 70 1 190 8 1</BR>
;――――――――――――――――――――――――――――――将单价乘以数量后写入总价格</BR>
MUL N$批量商铺购买物品总金额 &lt;$STR(N$商城当前购入物品单价)&gt; &lt;$STR(N$批量商铺购买物品数量)&gt;</BR>
#say</BR>
;――――――――――――――――――――――――――――――触发对话，并且调用之前已经提取号的IDX变量</BR>
&lt;ItemShow:&lt;$STR(N$商铺购买物品代码)&gt;:0:16:53:1&gt;
\</BR>
　\</BR>
　\</BR>
　　　　　　名称：&lt;$STR(S$商城当前购入物品名)&gt;\</BR>
　　　　　　单价：&lt;$STR(N$商城当前购入物品单价)&gt;金币\</BR>
　　　　　　说明：@关闭批量\</BR>
　\</BR>
　\</BR>
　\</BR>
;――――――――――――――――――――――――――――――修改批量购买商铺物品的数量，输入后会自动计算！</BR>
　　　　　　　&lt;$STR(N$批量商铺购买物品数量)&gt;个&lt;(修改数量)/@@InPutInteger300&gt;\</BR>
　\</BR>
　　　　　　　&lt;$STR(N$批量商铺购买物品总金额)&gt;金币\</BR>
　\</BR>
　　 &lt;批量购入/@批量购买&gt;　　 &lt;放弃购入/@放弃购入&gt;</BR></BR></BR>



;――――――――――――――――――――――――――――――修改批量物品数量后触发的字段</BR>
[@InPutInteger300]</BR>
#if</BR>
EQUAL N300 0</BR>
#act</BR>
;――――――――――――――――――――――――――――――将单价乘以数量后写入总价格</BR>
MUL N$批量商铺购买物品总金额 &lt;$STR(N$商城当前购入物品单价)&gt; &lt;$STR(N$批量商铺购买物品数量)&gt;</BR>
;――――――――――――――――――――――――――――――设置自定义对话框</BR>
OPENMERCHANTBIGDLG 176 19 1 0 10 70 1 190 8 1</BR>
#say</BR>
;――――――――――――――――――――――――――――――触发对话，并且调用之前已经提取号的IDX变量</BR>
&lt;ItemShow:&lt;$STR(N$商铺购买物品代码)&gt;:0:16:53:1&gt;
\</BR>
　\</BR>
　\</BR>
　　　　　　名称：&lt;$STR(S$商城当前购入物品名)&gt;\</BR>
　　　　　　单价：&lt;$STR(N$商城当前购入物品单价)&gt;金币\</BR>
　　　　　　说明：@关闭批量\</BR>
　\</BR>
　\</BR>
　\</BR>
;――――――――――――――――――――――――――――――修改批量购买商铺物品的数量，输入后会自动计算！</BR>
　　　　　　　&lt;$STR(N$批量商铺购买物品数量)&gt;个&lt;(修改数量)/@@InPutInteger300&gt;\</BR>
　\</BR>
　　　　　　　&lt;$STR(N$批量商铺购买物品总金额)&gt;金币\</BR>
　\</BR>
　　&lt;批量购入/@批量购买&gt;　　&lt;放弃购入/@放弃购入&gt;</BR></BR></BR>



;――――――――――――――――――――――――――――――所有条件满足开始执行批量购买</BR>
[@批量购买]</BR>
#IF</BR>
;――――――――――――――――――――――――――――――检测人物当前是否有足够的金币来购买，当然你也可以换成任何其他货币如元宝之类的</BR>
checkgold &lt;$STR(N$批量商铺购买物品总金额)&gt;</BR>
#ACT</BR>
take 金币 &lt;$STR(N$批量商铺购买物品总金额)&gt;</BR>
;――――――――――――――――――――――――――――――给予人物购买的物品名+数量</BR>
give &lt;$STR(S$商城当前购入物品名)&gt; &lt;$STR(N$批量商铺购买物品数量)&gt;</BR>
#ELSEACT</BR>
;――――――――――――――――――――――――――――――不满足输入条件时候触发字段</BR>
MessageBox 缺少“&lt;$STR(N$批量商铺购买物品总金额)&gt;”个金币无法购买！</BR></BR>


[@放弃购入]</BR>
#act</BR>
;――――――――――――――――――――――――――――――结束批量购入对话和其他对话，因为之前已经调用了自定义，</BR>
;――――――――――――――――――――――――――――――为避免直接点击其他NPC出错我们则用引擎说明书中的关闭命令来关闭，</BR>
;――――――――――――――――――――――――――――――最后指向正常的脚本结束语</BR>
CloseBigDialogBox</BR>
CLOSEMERCHANTBIGDLG</BR>
;――――――――――――――――――――――――――――――指向普通脚本结束语</BR>
close</BR>



</BR></BR></BR></BR></BR></BR></BR></BR></BR>








</br></br>
</br></br>
</br></br>





</br></br>

<p>&nbsp;</p>
<p>&nbsp;</p>
</body>
</html>
