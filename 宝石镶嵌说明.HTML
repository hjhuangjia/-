<html>

<head>
<meta http-equiv="Content-Language" content="zh-cn">
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>镶嵌宝石设置说明</title>
</head>

<body>
<br><br>
<font color="#0000FF"><b>凹槽宝石设置</b></font><br>
StdMode：46<br>
Shape：3<br>
Anicount：1、防御 2、魔御 3、攻击 4、魔法 5、道术 6、生命值 7、魔法值 8、准确 9、敏捷 10、幸运 11、攻击速度 12、魔法躲避 13、毒物躲避 14、中毒恢复 15、体力恢复 16、魔法恢复 17、负重(穿戴) 18、负重（背包）19、刺术  20、箭术  21、武力<br>
Source：所加属性值<br>
AC：1、暴击几率 2、攻击伤害 3、物伤减少 4、魔伤减少 5、忽视防御 6、伤害反弹 7、人物暴率 8、体力增加 9、魔力增加 10、怒气恢复 11、合击伤害 12、怪物暴率 13、防暴几率 14、防止麻痹 15、防止护身 16、防止复活 17、防止全毒 18、防止诱惑 19、防止火墙 20、防止冰冻 21、防止蛛网 22、为麻痹  23、为复活  24、为护身  25、为魔道麻痹 26、冰冻 27、蜘蛛网 28、致命一击 29、致命威力 30、致命防御 31、暴击抗性 32、攻击伤害抗性 33、杀怪经验倍数<br>
AC2：所加元素属性值<br>
Reserved：0为卸下宝石后宝石不消失、大于0则表示卸下宝石后宝石将消失<br><br>

注：Anicount字段为12、13、14、15、16有效附加属性值设置1-10，分别对应10% - 100%<br><br>
当宝石AC字段是15-27时候，数据库ac2为百分比机率 (1-100最大100.有二次几率的设置0也为100%，比如麻痹,冰冻,蜘蛛网)，比如1-100 为几率进入麻痹几率，比如M2麻痹几率5 时间5，宝石几率50% 意思就是有50%机会进入到麻痹几率・・麻痹几率为控制是否麻痹生效~<br><br>
=================================================================================================================<br><br>

<font color="#0000FF"><b>宝石卸下设置</b></font><br>
<b><font color="#0000FF">功能：</font></b><br>
&nbsp;&nbsp;&nbsp; 可将装备凹槽中的宝石取下<br>
<br>

</font><font face="Fixedsys" size="2"><strong><font color="#0000ff">格式：</font></strong><br>
&nbsp;&nbsp;&nbsp; 脚本头添加(@ArmRemoveStone)<br>
&nbsp;&nbsp;&nbsp; NPC对话按钮&nbsp;&nbsp;&nbsp; &lt;卸下宝石/@ArmRemoveStone&gt;<br>
&nbsp;&nbsp;&nbsp; 点击后调用卸下宝石对话框进行操作<br>
<br>

<font color="#0000FF"><b>示例：</b></font><br>
<br>
(@ArmRemoveStone)</font><font face="Arial" size="2"><font face="Fixedsys" size="2"><br>
[@main]<br>
</font><font face="Fixedsys" size="2">　有什么我可以帮你的。\ \<br>
</font></font><font face="Fixedsys" size="2">&lt;卸下宝石/@ArmRemoveStone&gt;\<br>
</font><font face="Fixedsys">&lt;关闭/@exit&gt;\<br>
<br>
<font color="#0000FF"><b>数据库设置：<br>
</b></font><br>
在物品数据库StdItems.DB里设置如下：<br>
卸下宝石道具<br>
Stdmode = 46<br>
Shape = 9<br><br>

=================================================================================================================<br><br>
<b>物品备注示例：</b><br>
<font color="#FF0000">ItemDescList.txt--物品备注MIR200目录中查找，或者M2-列表信息二中查找</b></font><br>
    宝石=250/将需镶嵌装备放入背包后鼠标右键点击宝石\250/当宝石变成准星后移动到需镶嵌武器上点击左键即可<br>
    混元锤=250/鼠标右键点击锤子，移动锤子到卸下宝石窗口\250/对准需卸下宝石点击即可卸下宝石<br><br>

=================================================================================================================<br><br>
<font color="#0000FF"><b>相关操作命令（可使用自定义OK框制作自己喜欢的镶嵌功能）</b></font><br>
<font color="#FF0000">打孔命令：</font><br>
SETFLUTECOUNT 位置 数量<br>
位置如下：<br>
-1 升级框<br>
0--25：装备栏<br>
30-35：首饰盒<br>
40-51：神佑袋<br>
boxitem0-boxitem7：OK框<br><br><br><br>


<font color="#FF0000">检测打孔数量命令：</font><br>
CheckFluteCount 位置 （&lt;、=、&gt;）数量<br>
位置如下：<br>
-1 升级框<br>
0--25：装备栏<br>
30-35：首饰盒<br>
40-51：神佑袋<br>
boxitem0-boxitem7：OK框<br><br><br><br>



<font color="#FF0000">检测物品镶嵌宝石数量：</font><br>
CheckItemStoneCount  装备位置  （&lt;、=、&gt;） 数量<br>
位置如下：<br>
-1 升级框<br>
0--25：装备栏<br>
30-35：首饰盒<br>
40-51：神佑袋<br>
boxitem0-boxitem7：OK框<br><br><br><br>


<font color="#FF0000">检测装备是否镶嵌指定宝石：</font><br>
命令格式：<br>
CheckItemHasStone 装备位置 宝石名称 数量<br><br><br>

<font color="#FF0000">镶嵌宝石QF触发：</font><br>

@BagUseStoneItemOK <br><br>

<font color="#FF0000">卸下宝石QF触发：</font><br>
@RemoveStoneItem<br><br><br>
--------------------------------------------<br><br>
<font color="#FF0000">检测人物全身镶嵌指定宝石数量：</font><br>
格式： 命令  宝石名称 数量<br>
CheckStoneCount 宝石名 &gt;&lt;= 数量<br><br><br><br><br>

------------------------------------------------------------------------------------------------------<br><br>

关闭装备打孔： CloseItemFlute 装备位置  关闭的打孔数量 <br><br>

注：关闭后原镶嵌的宝石和属性全部消失！<br><br>



------------------------------------------------------------------------------------------------------<br>

<font color="#FF0000">使用OK框镶嵌宝石：</font><br>
命令：ItemFluteStone 装备在OK框中的位置(0-7)  宝石在OK框中的位置(0-7)<br>

注意：boxitem0-boxitem7：OK框位置,此命令不需要填写boxitem，正确为：ItemFluteStone  0  1<br><br>
---------------------------------------------------------------------------------------------------<br>




<font color="#FF0000">相关QF触发：</font><br>
镶嵌成功后触发：@BagUseStoneItemOK<br><br><br>



<B>*******************************************2019-10-09扩展触发支持关联********************************************************</B><br><br>

示范脚本：<br><br>
[@BagUseStoneItemOK]<br>
#ACT<br>
LinkPickupItem<br>
ChangeItemName -1 新的名称<br>
SENDMSG 0 镶嵌装备已改为“新的名称”<br>
; 获取宝石名称<br>
GetDBIdxItemFieldValue  &lt;$UseStoneItemIndex&gt; name S1<br>
SendMsg 0 使用的宝石Idx:&lt;$UseStoneItemIndex&gt;，宝石名称:&lt;$Str(S1)&gt;<br>
; 获取装备Idx<br>
GetItemFieldValue -1 idx S1<br>
; 获取装备名称（含改名）<br>
GetItemFieldValue -1 name_g S2<br>
; 获取装备数据库名称<br>
GetItemFieldValue -1 name S3<br>
clearLinkItem<br>
SendMsg 0 当前操作的装备Idx：&lt;$Str(S1)&gt;；名称：&lt;$Str(S2)&gt;，数据库名称：&lt;$Str(S3)&gt;<br><br>





=================================================================================================================<br><br>


<font color="#0000FF"><b>示例脚本（集成调用）</b></font><br>
[@MAIN]<br>
&lt;给装备打孔增加凹槽/@凹槽页面&gt;\<br>
&lt;关闭/@exit&gt;\<br><br>

[@凹槽页面]<br>
请先把想要改良的装备穿在身上，然后在下方选择对应的装备位置\进行操作：\\<br>
   &lt;武器/@Flut1_1&gt;<br><br>
<font color="#FF0000">;以武器为例</b></font></b><br>
(增加1个凹槽,100%成功率)\<br>
(增加2个凹槽,100%成功率)\<br>
(增加3个凹槽,100%成功率)\<br>
(增加4个凹槽,100%成功率)\<br>
(增加5个凹槽,100%成功率)\<br>
(增加6个凹槽,100%成功率)\<br>
(增加7个凹槽,100%成功率)\<br>
(增加8个凹槽,100%成功率)\<br>
&lt;返回主菜单/@MAIN&gt;   &lt;关闭/@exit&gt;\<br><br>




[@Flut1_1]<br>
#IF<br>
NOT CHECKUSEITEM 1<br>
#SAY<br>
　您身上的该位置(武器) 未检测到装备，\<br>
请先穿戴好装备，再进行改良操作！\ \<br>
&lt;返回重新选取/@凹槽页面&gt;\<br>
&lt;关闭/@exit&gt;\<br>
#ELSESAY<br>
　本次选取“&lt;$WEAPON&gt;”进行操作，\\<br>
&lt;增加[1]个凹槽(成功率:100%)/@Flut1_1_1&gt;\<br>
&lt;增加[2]个凹槽(成功率:100%)/@Flut1_1_2&gt;\ <br>
&lt;增加[3]个凹槽(成功率:100%)/@Flut1_1_3&gt;\ <br>
&lt;增加[4]个凹槽(成功率:100%)/@Flut1_1_4&gt;\ <br>
&lt;增加[5]个凹槽(成功率:100%)/@Flut1_1_5&gt;\ <br>
&lt;增加[6]个凹槽(成功率:100%)/@Flut1_1_6&gt;\<br> 
&lt;增加[7]个凹槽(成功率:100%)/@Flut1_1_7&gt;\<br> 
&lt;增加[8]个凹槽(成功率:100%)/@Flut1_1_8&gt;\ <br>
&lt;返回重新选取/@凹槽页面&gt;\<br>
&lt;关闭/@exit&gt;\<br><br>

[@Flut1_1_1]<br>
#IF<br>
#ACT<br>
SETFLUTECOUNT 1 1<br>
<font color="#FF0000">;给予装备位置武器增加一个凹槽</b></font></b><br>
#SAY<br>
　恭喜，本次成功为装备增加了[1]个凹槽，\<br>
赶紧查看一下吧。\ \<br>
&lt;返回主菜单/@MAIN&gt;\<br>
&lt;关闭/@exit&gt;\<br><br>

[@Flut1_1_2]<br>
#IF<br>
#ACT<br>
SETFLUTECOUNT 1 2<br>
<font color="#FF0000">;给予装备位置武器增加两个凹槽</b></font></b><br>
#SAY<br>
　恭喜，本次成功为装备增加了[2]个凹槽，\<br>
赶紧查看一下吧。\ \<br>
&lt;返回主菜单/@MAIN&gt;\<br>
&lt;关闭/@exit&gt;\<br>

[@Flut1_1_3]<br>
#IF<br>
#ACT<br>
SETFLUTECOUNT 1 3<br>
#SAY<br>
　恭喜，本次成功为装备增加了[3]个凹槽，\<br>
赶紧查看一下吧。\ \<br>
&lt;返回主菜单/@MAIN&gt;\<br>
&lt;关闭/@exit&gt;\<br>

[@Flut1_1_4]<br>
#IF<br>
#ACT<br>
SETFLUTECOUNT 1 4<br>
#SAY<br>
　恭喜，本次成功为装备增加了[4]个凹槽，\<br>
赶紧查看一下吧。\ \<br>
&lt;返回主菜单/@MAIN&gt;\<br>
&lt;关闭/@exit&gt;\<br>

[@Flut1_1_5]<br>
#IF<br>
#ACT<br>
SETFLUTECOUNT 1 5<br>
#SAY<br>
　恭喜，本次成功为装备增加了[5]个凹槽，\<br>
赶紧查看一下吧。\ \<br>
&lt;返回主菜单/@MAIN&gt;\<br>
&lt;关闭/@exit&gt;\<br>

[@Flut1_1_6]<br>
#IF<br>
#ACT<br>
SETFLUTECOUNT 1 6<br>
#SAY<br>
　恭喜，本次成功为装备增加了[6]个凹槽，\<br>
赶紧查看一下吧。\ \<br>
&lt;返回主菜单/@MAIN&gt;\<br>
&lt;关闭/@exit&gt;\<br>

[@Flut1_1_7]<br>
#IF<br>
#ACT<br>
SETFLUTECOUNT 1 7<br>
#SAY<br>
　恭喜，本次成功为装备增加了[7]个凹槽，\<br>
赶紧查看一下吧。\ \<br>
&lt;返回主菜单/@MAIN&gt;\<br>
&lt;关闭/@exit&gt;\<br>

[@Flut1_1_8]<br>
#IF<br>
#ACT<br>
SETFLUTECOUNT 1 8<br>
<font color="#FF0000">;给予装备位置武器增加8个凹槽</b></font></b><br>
#SAY<br>
　恭喜，本次成功为装备增加了[8]个凹槽，\<br>
赶紧查看一下吧。\ \<br>
&lt;返回主菜单/@MAIN&gt;\<br>
&lt;关闭/@exit&gt;\<br><br>



=================================================================================================================<br><br>


<font color="#0000FF"><b>参数详解：</b></font><br><br>
[@Flut1_0]为衣服<br>
[@Flut1_1]为武器 <br> 
[@Flut1_3]为项链<br>
依次类推，最后的数字是装备位置！<br><br><br>

[@Flut1_1_1] 表示给武器打第一个孔<br>
....中间省略说明...依次类推...<br>
[@Flut1_1_8] 表示给武器打第八个孔<br><br>

[@Flut1_0_1] 表示给衣服打第一个孔<br>
....中间省略说明...依次类推...<br>
[@Flut1_0_8] 表示给衣服打第八个孔<br><br>

[@Flut1_3_1] 表示给项链打第一个孔<br>
....中间省略说明...依次类推...<br>
[@Flut1_3_8] 表示给项链打第八个孔<br><br><br>

其他自己按照装备位置和孔数自己对应即可！（装备位置如下：）<br><br><br><br><br>

    0  盔甲<br>
    1  武器<br>
    2  照明物（蜡烛，此物品属性升级无效）<br>
    3  项链<br>
    4  头盔<br>
    5  右手镯<br>
    6  左手镯<br>
    7  右戒指<br>
    8  左戒指<br>
    9  无(放护身符位置)<br>
    10 腰带<br>
    11 鞋子<br>
    12 宝石<br>
    13 斗笠<br>
    14 军鼓<br>
    15 马牌<br>
    16 盾牌<br>
    17 灵玉<br>
    18 时装衣服<br>
    19 时装武器<br>
    20 时装项链<br>
    21 时装头盔<br>
    22 时装左手镯<br>
    23 时装右手镯<br>
    24 时装左戒指<br>
    25 时装右戒指<br>
    26 时装勋章<br>
    27 时装腰带<br>
    28 时装靴子<br>
    29 时装宝石<br>
    30-35 首饰盒<br>
    40-51 生肖盒<br><br><br>



=================================================================================================================<br><br>
<font color="#FF0000"><b>获取装备宝石的属性</b></font><br><br>

GetItemStoneInfo <br>
功能说明：可以获取装备上面的每个宝石的数据 <br><br>


GetItemStoneInfo 装备位置  宝石位置（0-7） 属性类型(0-5) 变量<br>

属性类型：<br>
参数3为 0 时 获取 宝石Name看【0】介绍<br>
参数3为 1 时 获取宝石类型（攻击魔法道术之类的）看【1】介绍<br>
参数3为 2 时 获取宝石属性值 看【2】介绍<br>
参数3为 3 时 获取宝石元素类型 看【3】介绍<br>
参数3为 4 时 获取宝石元素属性值 看【4】介绍<br>
参数3为 5 时 获取卸下宝石是否消失  看【5】介绍<br>
参数3为 6 时 获取宝石叠加数量 (相同属性宝石可以叠加镶嵌)<br>

【0】：Name<br>
【1】: Anicount：1、防御 2、魔御 3、攻击 4、魔法 5、道术 6、生命值 7、魔法值 8、准确 9、敏捷 10、幸运 11、攻击速度 12、魔法躲避 13、毒物躲避 14、中毒恢复 15、体力恢复 16、魔法恢复 17、负重(穿戴) 18、负重（背包）<br>
【2】: Source：所加属性值<br>
【3】: AC：1、暴击几率 2、攻击伤害 3、物伤减少 4、魔伤减少 5、忽视防御 6、伤害反弹 7、人物暴率 8、体力增加 9、魔力增加 10、怒气恢复 11、合击伤害 12、怪物暴率 13、防暴几率 14、防止麻痹 15、防止护身 16、防止复活 17、防止全毒 18、防止诱惑 19、防止火墙 20、防止冰冻 21、防止蛛网 22、为麻痹  23、为复活  24、为护身  25、为魔道麻痹 26、冰冻 27、蜘蛛网 28、致命一击 29、致命威力 30、致命防御 31、暴击抗性 32、攻击伤害抗性<br>
【4】: AC2：所加元素属性值<br>
【5】: Reserved：0为卸下宝石后宝石不消失、大于0则表示卸下宝石后宝石将消失<br><br>
<br>
示例：<br>
[@main]<br>
&lt;获取武器装备宝石的属性/@获取武器装备宝石的属性&gt;\<br><br>
[@获取装备装备宝石的属性]<br>
#IF<br>
#ACT<br>
GetItemStoneInfo 1 0 0 &lt;$STR(S$宝石名称)&gt;<br>
GetItemStoneInfo 1 0 1 &lt;$STR(S$宝石类型)&gt; <br>
GetItemStoneInfo 1 0 2 &lt;$STR(S$宝石属性值)&gt;<br>
SENDMSG 6 你的武器的第一个宝石名称为【&lt;$STR(S$宝石名称)&gt;】<br>
SENDMSG 6 你的武器的第一个宝石属性类型为【&lt;$STR(S$宝石类型)&gt;】<br>
SENDMSG 6 你的武器的第一个宝石攻击属性为【&lt;$STR(S$宝石属性值)&gt;】<br><br>
=================================================================================================================<br><br>
命令功能说明：<br>
<font color="#FF0000">对人物 英雄身上的装备进行镶嵌宝石</b></font> <br>
ItemFluteStoneEx 装备位置  宝石名  <br>
H.ItemFluteStoneEx 装备位置  宝石名  <br>
英雄使用H.ItemFluteStoneEx 请确保英雄包裹里有指定宝石 <br><br>

示例：<br>
[@main]<br>
&lt;镶嵌身上武器装备/@镶嵌身上武器装备&gt;\<br><br><br>
[@镶嵌身上武器装备]<br>
#if<br>
#act<br>
ItemFluteStoneEx 1 麻痹宝石5级<br>
;注意英雄包裹里要有宝石才行<br>
H.ItemFluteStoneEx 1 麻痹宝石5级<br><br>

=================================================================================================================<br><br>
<font color="#FF0000"><b>附加说明：</b></font><br><br>

装备打孔最多可打8个孔，每个宝石最多同时支持2个属性（常规属性+元素属性）<br><br>

关于打孔成功率大家可以自己在脚本中增加几率控制<br><br>

镶嵌其他相关控制：M2-物品装备-特殊属性-基本选项<br><br>

===============================================以下为单独的功能操作命令（无需宝石直接命令镶嵌数据库中的宝石到装备上）=================================================================<br><br>
脚本命令给物品镶嵌宝石（无需宝石直接镶嵌）    </P>  



// ++++++++++++++++++++++++++++++++++ 检测装备对应的孔位置是否有宝石;孔位置 (1-8) </br>
CheckItemFluteIndexHasStone  装备位置  孔位置  </br></br>


// ################################################## 直接给装备加一个宝石（不需要包裹中有宝石）</br>
ItemAddStone 装备位置 宝石名 孔位置(0或空表示自动空孔位，1-8：指定位置)</br></br>

// 删除装备指定孔位的宝石孔位置 (1-8)    </br>

ItemDelStone 装备位置 孔位置 </br></br>




// 2019-02-01增加取下镶嵌宝石命令：</br>
ItemoffStone 装备位置  孔位置（1-8）</br></br></br>










